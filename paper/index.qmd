---
title: "Julia for Applied Infectious Disease Modelling"
author:
  - name: "Samuel Abbott"
    affiliation: "Centre for Mathematical Modelling of Infectious Diseases, London School of Hygiene & Tropical Medicine"
    email: "sam.abbott@lshtm.ac.uk"
    orcid: "0000-0001-8057-8037"
date: today
abstract: |
  This paper explores the potential of the Julia programming language in applied infectious disease modelling.
  Through practical case studies, we demonstrate Julia's capabilities in implementing epidemiological models efficiently whilst maintaining readability and reproducibility.
format:
  pdf:
    documentclass: article
    geometry: margin=1in
    fontsize: 11pt
    linestretch: 1.5
    keep-tex: false
    number-sections: true
    colorlinks: true
bibliography: library.bib
csl: https://www.zotero.org/styles/plos-computational-biology
execute:
  echo: true
  warning: false
  cache: true
julia:
  exeflags: ["--threads=4", "-O3"]
---

## Introduction
Infectious disease modelling (IDM) plays a critical role in public health decision-making, from outbreak response to long-term planning.
The field faces mounting challenges as models grow increasingly complex, incorporate a greater range of real-time data streams, and explore more intervention scenarios.
This complexity manifests in both computational demands and code maintenance challenges, making it difficult to produce impactful work within the timescales that matter when responding rapidly to emerging threats.

Modern outbreak response often requires rapid development and deployment of novel methods, frequently combining multiple modelling approaches to address emerging threats.
This challenge is highlighted by tools like EpiNow2 and EpiNowcast, which despite their success, have struggled to integrate novel features and methodological advances from the broader modelling community.
The difficulty in incorporating external contributions and specialised backend tools, even for established projects, highlights a challenge in the field.
While approaches like epidist, which builds on top of brms, demonstrate one path toward integration, such solutions are often limited in scope and only available for certain model types.

There are all so challenges in wider epidemiological research practice.
The implementation of Bayesian workflows remains particularly challenging for many practitioners, requiring expertise in both statistical methodology and computational techniques.
Furthermore, the current paradigm of research study development often requires teams to rebuild complex model frameworks from scratch, leading to duplicated effort, potential inconsistencies, and slower scientific progress.
Even with advances in computing power, the persistent tension between computational performance and accessibility continues to impede both rapid outbreak response and longer-term research projects, where sophisticated models must be balanced against practical constraints of time and expertise.

Several solutions have been proposed to address these challenges, including domain-specific tools like odin and pomp, as well as general-purpose probabilistic programming languages like Stan and JAX. While these tools have made important contributions, they often face significant limitations.
Domain-specific solutions, while powerful for their intended use cases, typically lack integration with broader scientific computing ecosystems, making it difficult to leverage advances in fields like differential equations or optimization.
Meanwhile, general-purpose tools like Stan and JAX, despite their mathematical sophistication, can be challenging to use effectively without substantial programming expertise.
Furthermore, the development of efficient algorithms and implementation patterns often falls to domain experts rather than being handled by dedicated numerical computing specialists, leading to potential inefficiencies and missed opportunities for optimization.

This paper explores how Julia [@bezanson2017julia] may bridge this gap through its unique combination of high performance, composability, intuitive syntax, and robust scientific ecosystem.
Through detailed examination of Julia's multiple dispatch system, native performance capabilities, and metaprogramming features, we demonstrate how the language could address core challenges in infectious disease modeling.
Our analysis spans the implementation of differential equation models using the SciML ecosystem, Bayesian inference with Turing.jl, and the application of automatic differentiation for parameter estimation and sensitivity analysis.
Using practical case studies in outbreak modeling, we show how Julia's coherent package ecosystem enables modelers to seamlessly combine traditionally separate computational approaches while maintaining code that is both efficient and accessible to domain experts, potentially transforming how we approach computational epidemiology.

## The Current Landscape of Infectious Disease Modeling

### Common Infectious Disease Modelling methods

### Challenges in Modern IDM

- Discussion of the increasing complexity of models, need for rapid deployment during outbreaks, and computational bottlenecks in existing approaches.
- Lack of adoption of bayesian infectious disease modelling workflows

### Common Tools and Their Limitations
Overview of R, Python, and other current tools, their strengths and limitations in the IDM context.

## Julia

### The Language

- Multiple Dispatch and Type System
- Native Performance
- Metaprogramming
- Package Interoperability
- Interactive
- Auto-differentation

### The Ecosystem

#### The Scientific Machine Learning Ecosystem (SciML)

#### Julia for Mathematical Programming (JuMP)

#### Applied Category Theory in Julia (AlgebraicJulia)

- EpiCats.jl

#### Turing.jl

- ecosystem
- PPL
- DynamicPPL
- JuliaBugs
- Inference
- Other cool stuff?

#### Gen.jl and RxInfer.jl

#### Other Model Fitting Options

- Pigeons.jl parallel tempering - PPL agnostic
- Others?

#### Neural networks

- Lux.jl https://lux.csail.mit.edu/stable/introduction/overview

#### Automatic Differentiation

- Able to switch to different auto differentiation approaches
- Enables picking the one that works best for your problem
- Also allows for benefiting from ongoing research as can swap in new options as they become available.
- Forward differentiation and reverse differentiation
- Enzyme, Mooncake

### Data Science Tools

Julia provides a comprehensive data science ecosystem that complements its scientific computing capabilities.
DataFrames.jl and DataFramesMeta.jl offers powerful tabular data manipulation, while visualization libraries like Makie.jl.
The AlgebraOfGraphics.jl (AoG) package provides a grammar of graphics system, and the Tidier.jl ecosystem brings familiar data wrangling patterns to Julia users.
These tools integrate seamlessly with the modeling and inference capabilities discussed above, enabling end-to-end workflows from data preparation through analysis and visualization.

## Case Studies

Julia has already been used successfully in several epidemiological modelling studies, demonstrating its growing adoption within the infectious disease modelling community.
A notable example is the Epirecipes project [@epirecipes], originally a multi-language collection of epidemiological models, which has increasingly focused on Julia implementations.
The project serves as a comprehensive "cookbook" of epidemiological models, showcasing Julia's versatility through diverse approaches to classical models like SIR: from compositional modelling using AlgebraicJulia's category theory framework (EpiCats), to Bayesian parameter estimation with Gen.jl, to advanced stochastic processes and bifurcation analysis.
This demonstrates how Julia's ecosystem enables researchers to explore the same epidemiological concepts through multiple complementary computational paradigms whilst maintaining code reusability and mathematical rigour.
The following case studies build upon this foundation to illustrate specific aspects of Julia's capabilities for infectious disease modelling.

### Case Study 1: Compartmental Susceptible-Exposed-Infectious-Recovered (SEIR) Model with time-varying transmission rate

1. ODE Model Specification
   - Define SEIR differential equations using SciML ecosystem
   - Implement core compartmental structure
   - Validate numerical stability and solver choice

2. Time-varying Transmission Rate
   - AR(1) process model for transmission rate β(t)
   - Connect latent AR process to ODE system dynamics
   - Leverage existing parameter validation from previous case

3. Observation Process
   - Apply negative binomial observation model
   - Extend observation layer to capture:
     - Incidence data from E→I transitions
     - Prevalence data from I compartment

4. Complete Model Integration
   - Combine deterministic ODE backbone with stochastic components
   - Link transmission process to compartmental dynamics
   - Connect compartmental states to observation layer
   - Implement efficient Bayesian inference pipeline

5. Model Validation
   - Simulate data from the model
   - Fit to the simulated data i.e. SBC
   - Simulate a known beta scenario
   - Fit and recover from it.

### Case study 2: TBD

Potential options:

- Petri net composition of a SEIR model with age structure and variant dynamics. Simulate from and integrate into Turing for fitting. Something like: https://github.com/epirecipes/EpiCats/blob/main/pn_stratify_ageclasses/pn_stratify_ageclasses.md but extended.
- Agent.jl model to Gen.jl via Genify.jl (https://github.com/probcomp/Genify.jl)
- Neural ODEs: SEIR w/ AR + NN interaction terms: https://github.com/vboussange/HybridDynamicModels.jl
- UDEs SEIR with NN on multiple datasets: https://www.sciencedirect.com/science/article/pii/S240584402401394X

Some or all of the case studies likely need to include real data to convince applied modellers at the same time we want to keep the high level and schematic to make this achievable and to make sure we can communicate the key points.

### Case study 3 : TBD

## Discussion

This paper has demonstrated Julia's potential to address key challenges in infectious disease modelling through its unique combination of performance, composability, and scientific ecosystem integration.
Through examination of Julia's core features and practical case studies, we have shown how the language can bridge the gap between computational performance and accessibility for epidemiological applications.

<!-- Summary of key findings -->
-   Demonstrated Julia's unique position in scientific computing for IDM through multiple dispatch, native performance, and seamless package interoperability
-   Showed how ecosystem components work together cohesively, enabling "two-language problem" elimination from prototyping to production
-   Illustrated practical benefits through case studies spanning differential equations, Bayesian inference, and automatic differentiation

<!-- Strengths and limitations interwoven -->
-   True language-level composability between packages enables rapid model development and component reuse, though requires learning curve for researchers familiar with monolithic approaches in R/Python
-   Rich type system enabling both safety and performance facilitates systematic model validation, yet compilation times can impact interactive development workflow
-   Growing, academically-focused ecosystem provides cutting-edge scientific computing tools, however IDM-specific tooling remains limited compared to established R/Python packages
-   Native performance eliminates computational bottlenecks common in other high-level languages, but smaller community means fewer domain-specific examples and tutorials

<!-- Comparison to literature - JAX and NumPyro -->
While JAX offers automatic differentiation and acceleration, it remains a framework rather than a language solution, leading to limited expressiveness due to Python's underlying type system, restricted functional programming patterns, and complex deployment challenges.
Julia's multiple dispatch provides more natural problem expression for epidemiological models, particularly when implementing complex infectious disease models with feedback loops, integrating real-time data streams for forecasting, or mixing deterministic and stochastic model components.

<!-- Comparison to literature - Stan and related tools -->
Traditional probabilistic programming languages like Stan suffer from limited flexibility in model specification, separation between modelling and analysis environments, and performance overhead from interface translations.
Julia's native probabilistic programming through Turing.jl addresses these limitations whilst supporting stochastic differential equations, discrete event simulation, and agent-based modelling approaches that are essential for comprehensive infectious disease analysis.

<!-- Future work -->
Areas for future work include developing a cohesive epidemiology metapackage that provides domain-specific abstractions for common IDM patterns whilst connecting to the broader Julia ecosystem.
Priority areas include standardised interfaces for model specification, parameter estimation, intervention modelling, and real-time forecasting.
Technical improvements needed include further reducing compilation latency, expanding GPU support across the ecosystem, and developing IDM-specific visualisation recipes alongside standardised benchmarks for IDM applications.

<!-- Conclusions -->
Julia represents a significant advance in scientific computing for IDM, offering a unique combination of performance, expressiveness, and composability that addresses fundamental limitations of both pipeline and monolithic modelling approaches.
Whilst some challenges remain, the foundation is set for a robust, maintainable, and efficient approach to infectious disease modelling that can adapt to future computational and methodological advances.
Action must be taken to provide the necessary support for Julia adoption in the IDM community including composable, interoperable, and performant tools, educational materials, and community engagement.

## Acknowledgements

## References {.unnumbered}
::: {#refs}
:::
